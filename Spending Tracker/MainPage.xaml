<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Spending_Tracker.MainPage"
             Title="Cheltuieli"
             BackgroundColor="#F5F7FA">

    <Grid RowDefinitions="Auto,Auto,Auto,*,Auto" Padding="16">
        
        <!-- Modern Header with gradient effect -->
        <Border Grid.Row="0" 
                StrokeShape="RoundRectangle 24"
                Stroke="Transparent"
                Margin="0,0,0,16"
                Shadow="{Shadow Brush=#40000000, Offset='0,4', Radius=12, Opacity=0.3}">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                    <GradientStop Color="#6366F1" Offset="0.0" />
                    <GradientStop Color="#8B5CF6" Offset="1.0" />
                </LinearGradientBrush>
            </Border.Background>
            <Grid ColumnDefinitions="Auto,*" ColumnSpacing="20" Padding="24">
                <Border Grid.Column="0"
                        StrokeShape="RoundRectangle 16"
                        BackgroundColor="#FFFFFF20"
                        Padding="12"
                        VerticalOptions="Center">
                    <Image Source="money_bag.png"
                           HeightRequest="56"
                           WidthRequest="56"
                           Aspect="AspectFit"/>
                </Border>
                <VerticalStackLayout Grid.Column="1" VerticalOptions="Center" Spacing="4">
                    <Label Text="Total Cheltuieli" 
                           TextColor="#FFFFFFCC" 
                           FontSize="14"
                           FontFamily="OpenSans-Regular"/>
                    <Label x:Name="TotalLabel" 
                           Text="0.00 RON" 
                           TextColor="White" 
                           FontSize="36" 
                           FontAttributes="Bold"
                           FontFamily="OpenSans-Bold"/>
                    <Label Text="Luna Curentă" 
                           TextColor="#FFFFFF99" 
                           FontSize="12"
                           FontFamily="OpenSans-Regular"/>
                </VerticalStackLayout>
            </Grid>
        </Border>

        <!-- Modern Filter controls -->
        <Border Grid.Row="1" 
                StrokeShape="RoundRectangle 20"
                BackgroundColor="White"
                Stroke="#E5E7EB"
                StrokeThickness="1"
                Padding="16" 
                Margin="0,0,0,12"
                Shadow="{Shadow Brush=#20000000, Offset='0,2', Radius=8, Opacity=0.2}">
            <Grid ColumnDefinitions="*,*,Auto" ColumnSpacing="12">
                <Border Grid.Column="0" 
                        StrokeShape="RoundRectangle 12"
                        BackgroundColor="#F9FAFB"
                        Padding="12,8">
                    <DatePicker x:Name="StartDatePicker" 
                                Date="{Binding StartDate}"
                                DateSelected="OnFilterChanged"
                                FontSize="13"/>
                </Border>
                <Border Grid.Column="1" 
                        StrokeShape="RoundRectangle 12"
                        BackgroundColor="#F9FAFB"
                        Padding="12,8">
                    <DatePicker x:Name="EndDatePicker" 
                                Date="{Binding EndDate}"
                                DateSelected="OnFilterChanged"
                                FontSize="13"/>
                </Border>
                <Button Grid.Column="2" 
                        Text="Reset" 
                        Clicked="OnResetFilter"
                        BackgroundColor="#EF4444"
                        TextColor="White"
                        CornerRadius="12"
                        Padding="16,0"
                        FontSize="13"
                        FontAttributes="Bold"/>
            </Grid>
        </Border>

        <!-- Modern Category filter -->
        <Border Grid.Row="2" 
                StrokeShape="RoundRectangle 20"
                BackgroundColor="White"
                Stroke="#E5E7EB"
                StrokeThickness="1"
                Padding="16" 
                Margin="0,0,0,12"
                Shadow="{Shadow Brush=#20000000, Offset='0,2', Radius=8, Opacity=0.2}">
            <Picker x:Name="CategoryPicker" 
                    Title="Toate categoriile"
                    SelectedIndexChanged="OnFilterChanged"
                    HorizontalOptions="FillAndExpand"
                    FontSize="14"/>
        </Border>

        <!-- Modern ListView with expenses -->
        <ListView x:Name="ExpensesListView" 
                  Grid.Row="3"
                  ItemTapped="OnExpenseSelected"
                  HasUnevenRows="True"
                  SeparatorVisibility="None"
                  BackgroundColor="Transparent">
            <ListView.Header>
                <Label Text="Istoric Cheltuieli" 
                       FontSize="18" 
                       FontAttributes="Bold"
                       TextColor="#1F2937"
                       Margin="4,8,4,12"/>
            </ListView.Header>
            <ListView.ItemTemplate>
                <DataTemplate>
                    <ViewCell>
                        <SwipeView>
                            <SwipeView.RightItems>
                                <SwipeItems>
                                    <SwipeItem Text="Șterge" 
                                               BackgroundColor="#EF4444"
                                               Clicked="OnDeleteExpense"/>
                                </SwipeItems>
                            </SwipeView.RightItems>
                            <Border StrokeShape="RoundRectangle 16"
                                    BackgroundColor="White"
                                    Stroke="#E5E7EB"
                                    StrokeThickness="1"
                                    Padding="16" 
                                    Margin="0,0,0,12"
                                    Shadow="{Shadow Brush=#15000000, Offset='0,1', Radius=6, Opacity=0.15}">
                                <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto" ColumnSpacing="12">
                                    <Border Grid.Column="0" 
                                            Grid.RowSpan="2"
                                            StrokeShape="RoundRectangle 10"
                                            BackgroundColor="{Binding CategoryColor}"
                                            WidthRequest="48" 
                                            HeightRequest="48"
                                            VerticalOptions="Center">
                                        <Label Text="💰" 
                                               FontSize="20"
                                               HorizontalOptions="Center"
                                               VerticalOptions="Center"/>
                                    </Border>
                                    <Label Grid.Column="1" 
                                           Grid.Row="0"
                                           Text="{Binding Description}" 
                                           FontSize="15" 
                                           FontAttributes="Bold"
                                           TextColor="#1F2937"
                                           LineBreakMode="TailTruncation"/>
                                    <Label Grid.Column="1" 
                                           Grid.Row="1"
                                           Text="{Binding Category}" 
                                           FontSize="12" 
                                           TextColor="#6B7280"/>
                                    <VerticalStackLayout Grid.Column="2" 
                                                         Grid.RowSpan="2"
                                                         VerticalOptions="Center"
                                                         HorizontalOptions="End"
                                                         Spacing="2">
                                        <Label Text="{Binding AmountDisplay}" 
                                               FontSize="16" 
                                               FontAttributes="Bold"
                                               TextColor="#8B5CF6"
                                               HorizontalOptions="End"/>
                                        <Label Text="{Binding DateDisplay}" 
                                               FontSize="11" 
                                               TextColor="#9CA3AF"
                                               HorizontalOptions="End"/>
                                    </VerticalStackLayout>
                                </Grid>
                            </Border>
                        </SwipeView>
                    </ViewCell>
                </DataTemplate>
            </ListView.ItemTemplate>
        </ListView>

        <!-- Modern Floating Add button -->
        <Border Grid.Row="4" 
                StrokeShape="RoundRectangle 28"
                Stroke="Transparent"
                Margin="0,12,0,0"
                Shadow="{Shadow Brush=#40000000, Offset='0,4', Radius=16, Opacity=0.4}">
            <Border.Background>
                <LinearGradientBrush StartPoint="0,0" EndPoint="1,0">
                    <GradientStop Color="#6366F1" Offset="0.0" />
                    <GradientStop Color="#8B5CF6" Offset="1.0" />
                </LinearGradientBrush>
            </Border.Background>
            <Button Text="+ Adaugă Cheltuială" 
                    Clicked="OnAddExpense"
                    BackgroundColor="Transparent"
                    TextColor="White"
                    HeightRequest="56"
                    FontSize="16"
                    FontAttributes="Bold"/>
        </Border>
    </Grid>

</ContentPage>

